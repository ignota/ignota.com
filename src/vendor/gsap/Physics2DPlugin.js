/*!
 * VERSION: 0.2.1
 * DATE: 2018-05-30
 * UPDATES AND DOCS AT: http://greensock.com
 *
 * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
 * Physics2DPlugin is a Club GreenSock membership benefit; You must have a valid membership to use
 * this code without violating the terms of use. Visit http://greensock.com/club/ to sign up or get more details.
 * This work is subject to the software agreement that was issued with your membership.
 * 
 * @author: Jack Doyle, jack@greensock.com
 */
import{_gsScope}from"gsap/TweenLite.js";var _DEG2RAD=Math.PI/180,Physics2DProp=function(i,t,s,e,r){this.p=t,this.f="function"==typeof i[t],this.start=this.value=this.f?i[t.indexOf("set")||"function"!=typeof i["get"+t.substr(3)]?t:"get"+t.substr(3)]():parseFloat(i[t]),this.velocity=s||0,this.v=this.velocity/r,e||0===e?(this.acceleration=e,this.a=this.acceleration/(r*r)):this.acceleration=this.a=0},_random=Math.random(),_globals=_gsScope._gsDefine.globals,_rootFramesTimeline=_globals.com.greensock.core.Animation._rootFramesTimeline,Physics2DPlugin=_gsScope._gsDefine.plugin({propName:"physics2D",version:"0.2.1",API:2,init:function(i,t,s,e){"function"==typeof t&&(t=t(e,i)),this._target=i,this._tween=s,this._runBackwards=!0===s.vars.runBackwards,this._step=0;for(var r,n=s._timeline,o=Number(t.angle)||0,a=Number(t.velocity)||0,h=Number(t.acceleration)||0,_=t.xProp||"x",c=t.yProp||"y",l=t.accelerationAngle||0===t.accelerationAngle?Number(t.accelerationAngle):o;n._timeline;)n=n._timeline;return this._stepsPerTimeUnit=r=n===_rootFramesTimeline?1:30,t.gravity&&(h=Number(t.gravity),l=90),o*=_DEG2RAD,l*=_DEG2RAD,this._friction=1-Number(t.friction||0),this._overwriteProps.push(_),this._overwriteProps.push(c),this._x=new Physics2DProp(i,_,Math.cos(o)*a,Math.cos(l)*h,r),this._y=new Physics2DProp(i,c,Math.sin(o)*a,Math.sin(l)*h,r),this._skipX=this._skipY=!1,!0},set:function(i){var t,s,e,r,n,o,a=this._tween._time,h=this._x,_=this._y;if(!0===this._runBackwards&&(a=this._tween._duration-a),1===this._friction)e=a*a*.5,t=h.start+(h.velocity*a+h.acceleration*e),s=_.start+(_.velocity*a+_.acceleration*e);else{if(r=o=(0|(a*=this._stepsPerTimeUnit))-this._step,n=a%1,o>=0)for(;--o>-1;)h.v+=h.a,_.v+=_.a,h.v*=this._friction,_.v*=this._friction,h.value+=h.v,_.value+=_.v;else for(o=-o;--o>-1;)h.value-=h.v,_.value-=_.v,h.v/=this._friction,_.v/=this._friction,h.v-=h.a,_.v-=_.a;t=h.value+h.v*n,s=_.value+_.v*n,this._step+=r}this._skipX||(h.m&&(t=h.m(t,this._target)),h.f?this._target[h.p](t):this._target[h.p]=t),this._skipY||(_.m&&(s=_.m(s,this._target)),_.f?this._target[_.p](s):this._target[_.p]=s)}}),p=Physics2DPlugin.prototype;p._kill=function(i){return null!=i[this._x.p]&&(this._skipX=!0),null!=i[this._y.p]&&(this._skipY=!0),this._super._kill.call(this,i)},p._mod=function(i){var t=i[this._x.p]||i.physics2D;t&&"function"==typeof t&&(this._x.m=t),(t=i[this._y.p]||i.physics2D)&&"function"==typeof t&&(this._y.m=t)},Physics2DPlugin._autoCSS=!0,Physics2DPlugin._cssRegister=function(){var i=_globals.CSSPlugin;if(i){var t=i._internals,s=t._parseToProxy,e=t._setPluginRatio,r=t.CSSPropTween;t._registerComplexSpecialProp("physics2D",{parser:function(i,t,n,o,a,h){h=new Physics2DPlugin;var _,c=t.xProp||"x",l=t.yProp||"y",p={};return p[c]=p[l]=_random++,_=s(i,p,o,a,h),(a=new r(i,"physics2D",0,0,_.pt,2)).data=_,a.plugin=h,a.setRatio=e,h._onInitTween(_.proxy,t,o._tween),a}})}};export{Physics2DPlugin,Physics2DPlugin as default};
