/*!
 * VERSION: 0.11.1
 * DATE: 2018-05-30
 * UPDATES AND DOCS AT: http://greensock.com
 *
 * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
 * ThrowPropsPlugin is a Club GreenSock membership benefit; You must have a valid membership to use
 * this code without violating the terms of use. Visit http://greensock.com/club/ to sign up or get more details.
 * This work is subject to the software agreement that was issued with your membership.
 * 
 * @author: Jack Doyle, jack@greensock.com
 */
import{TweenLite,_gsScope,TweenPlugin,Ease}from"gsap/TweenLite.js";_gsScope._gsDefine("plugins.ThrowPropsPlugin",["utils.VelocityTracker","plugins.TweenPlugin","TweenLite","easing.Ease"],function(e){var t,r,n,i,o=function(e,t){TweenPlugin.call(this,"throwProps"),this._overwriteProps.length=0},s=999999999999999,a=_gsScope._gsDefine.globals,c=!1,p={x:1,y:1,z:2,scale:1,scaleX:1,scaleY:1,rotation:1,rotationZ:1,rotationX:2,rotationY:2,skewX:1,skewY:1,xPercent:1,yPercent:1},u=function(e,t,r,n,i){var o,a,c,p,u=t.length,l=0,f=s;if("object"==typeof e){for(;--u>-1;){for(c in o=t[u],a=0,e)a+=(p=o[c]-e[c])*p;a<f&&(l=u,f=a)}if((i||s)<s&&i<Math.sqrt(f))return e}else for(;--u>-1;)(a=(o=t[u])-e)<0&&(a=-a),a<f&&o>=n&&o<=r&&(l=u,f=a);return t[l]},l=function(e,t,r,n,i,o){if("auto"===e.end)return e;var a,c,p=e.end;if(r=isNaN(r)?s:r,n=isNaN(n)?-s:n,"object"==typeof t){if(a=t.calculated?t:("function"==typeof p?p(t):u(t,p,r,n,o))||t,!t.calculated){for(c in a)t[c]=a[c];t.calculated=!0}a=a[i]}else a="function"==typeof p?p(t):p instanceof Array?u(t,p,r,n,o):Number(p);return a>r?a=r:a<n&&(a=n),{max:a,min:a,unitFactor:e.unitFactor}},f=function(e,t,r){for(var n in t)void 0===e[n]&&n!==r&&(e[n]=t[n]);return e},g=o.calculateChange=function(e,t,r,n){return null==n&&(n=.05),r*n*e/(t instanceof Ease?t:t?new Ease(t):TweenLite.defaultEase).getRatio(n)},v=o.calculateDuration=function(e,t,r,n,i){i=i||.05;var o=n instanceof Ease?n:n?new Ease(n):TweenLite.defaultEase;return Math.abs((t-e)*o.getRatio(i)/r/i)},h=o.calculateTweenDuration=function(t,r,n,i,s,a){if("string"==typeof t&&(t=TweenLite.selector(t)),!t)return 0;null==n&&(n=10),null==i&&(i=.2),null==s&&(s=1),t.length&&(t=t[0]||t);var p,u,h,y,d,_,m,P,w,T,k,x,b,N=0,V=9999999999,O=r.throwProps||r,S=r.ease instanceof Ease?r.ease:r.ease?new Ease(r.ease):TweenLite.defaultEase,L=isNaN(O.checkpoint)?.05:Number(O.checkpoint),E=isNaN(O.resistance)?o.defaultResistance:Number(O.resistance);if(O.linkedProps)for(x=O.linkedProps.split(","),k={},b=0;b<x.length;b++)(u=O[p=x[b]])&&(h=(y=void 0!==u.velocity&&"number"==typeof u.velocity?Number(u.velocity)||0:(w=w||e.getByTarget(t))&&w.isTrackingProp(p)?w.getVelocity(p):0)*(d=isNaN(u.resistance)?E:Number(u.resistance))>0?y/d:y/-d,_="function"==typeof t[p]?t[p.indexOf("set")||"function"!=typeof t["get"+p.substr(3)]?p:"get"+p.substr(3)]():t[p]||0,k[p]=_+g(y,S,h,L));for(p in O)"resistance"!==p&&"checkpoint"!==p&&"preventOvershoot"!==p&&"linkedProps"!==p&&"radius"!==p&&("object"!=typeof(u=O[p])&&((w=w||e.getByTarget(t))&&w.isTrackingProp(p)?u="number"==typeof u?{velocity:u}:{velocity:w.getVelocity(p)}:h=(y=Number(u)||0)*E>0?y/E:y/-E),"object"==typeof u&&(h=(y=void 0!==u.velocity&&"number"==typeof u.velocity?Number(u.velocity)||0:(w=w||e.getByTarget(t))&&w.isTrackingProp(p)?w.getVelocity(p):0)*(d=isNaN(u.resistance)?E:Number(u.resistance))>0?y/d:y/-d,m=(_="function"==typeof t[p]?t[p.indexOf("set")||"function"!=typeof t["get"+p.substr(3)]?p:"get"+p.substr(3)]():t[p]||0)+g(y,S,h,L),void 0!==u.end&&(u=l(u,k&&p in k?k:m,u.max,u.min,p,O.radius),(a||c)&&(O[p]=f(u,O[p],"end"))),void 0!==u.max&&m>Number(u.max)+1e-10?(T=u.unitFactor||o.defaultUnitFactors[p]||1,(P=_>u.max&&u.min!==u.max||y*T>-15&&y*T<45?i+.1*(n-i):v(_,u.max,y,S,L))+s<V&&(V=P+s)):void 0!==u.min&&m<Number(u.min)-1e-10&&(T=u.unitFactor||o.defaultUnitFactors[p]||1,(P=_<u.min&&u.min!==u.max||y*T>-45&&y*T<15?i+.1*(n-i):v(_,u.min,y,S,L))+s<V&&(V=P+s)),P>N&&(N=P)),h>N&&(N=h));return N>V&&(N=V),N>n?n:N<i?i:N},y=o.prototype=new TweenPlugin("throwProps");return y.constructor=o,o.version="0.11.1",o.API=2,o._autoCSS=!0,o.defaultResistance=100,o.defaultUnitFactors={time:1e3,totalTime:1e3},o.track=function(t,r,n){return e.track(t,r,n)},o.untrack=function(t,r){e.untrack(t,r)},o.isTracking=function(t,r){return e.isTracking(t,r)},o.getVelocity=function(t,r){var n=e.getByTarget(t);return n?n.getVelocity(r):NaN},o._cssRegister=function(){var n=a.com.greensock.plugins.CSSPlugin;if(n){var i=n._internals,s=i._parseToProxy,c=i._setPluginRatio,u=i.CSSPropTween;i._registerComplexSpecialProp("throwProps",{parser:function(n,i,a,l,f,g){g=new o;var v,h,y,d,_={},m={},P={},w={},T={},k={};for(h in r={},i)"resistance"!==h&&"preventOvershoot"!==h&&"linkedProps"!==h&&"radius"!==h&&("object"==typeof(v=i[h])?(void 0!==v.velocity&&"number"==typeof v.velocity?_[h]=Number(v.velocity)||0:(d=d||e.getByTarget(n),_[h]=d&&d.isTrackingProp(h)?d.getVelocity(h):0),void 0!==v.end&&(w[h]=v.end),void 0!==v.min&&(m[h]=v.min),void 0!==v.max&&(P[h]=v.max),v.preventOvershoot&&(k[h]=!0),void 0!==v.resistance&&(!0,T[h]=v.resistance)):"number"==typeof v?_[h]=v:(d=d||e.getByTarget(n))&&d.isTrackingProp(h)?_[h]=d.getVelocity(h):_[h]=v||0,p[h]&&l._enableTransforms(2===p[h]));for(h in y=s(n,_,l,f,g),t=y.proxy,_=y.end,t)r[h]={velocity:_[h],min:m[h],max:P[h],end:w[h],resistance:T[h],preventOvershoot:k[h]};return null!=i.resistance&&(r.resistance=i.resistance),null!=i.linkedProps&&(r.linkedProps=i.linkedProps),null!=i.radius&&(r.radius=i.radius),i.preventOvershoot&&(r.preventOvershoot=!0),f=new u(n,"throwProps",0,0,y.pt,2),l._overwriteProps.pop(),f.plugin=g,f.setRatio=c,f.data=y,g._onInitTween(t,r,l._tween),f}})}},o.to=function(e,o,s,a,p){o.throwProps||(o={throwProps:o}),0===p&&(o.throwProps.preventOvershoot=!0),c=!0;var u=new TweenLite(e,a||1,o);return u.render(0,!0,!0),u.vars.css?(u.duration(h(t,{throwProps:r,ease:o.ease},s,a,p)),u._delay&&!u.vars.immediateRender?u.invalidate():n._onInitTween(t,i,u),c=!1,u):(u.kill(),u=new TweenLite(e,h(e,o,s,a,p),o),c=!1,u)},y._onInitTween=function(t,r,o,s){this.target=t,this._props=[],n=this,i=r;var a,p,u,v,h,y,d,_,m,P,w,T,k=o._ease,x=isNaN(r.checkpoint)?.05:Number(r.checkpoint),b=o._duration,N=r.preventOvershoot,V=0;if(r.linkedProps)for(w=r.linkedProps.split(","),P={},T=0;T<w.length;T++)(p=r[a=w[T]])&&(h=void 0!==p.velocity&&"number"==typeof p.velocity?Number(p.velocity)||0:(m=m||e.getByTarget(t))&&m.isTrackingProp(a)?m.getVelocity(a):0,u="function"==typeof t[a]?t[a.indexOf("set")||"function"!=typeof t["get"+a.substr(3)]?a:"get"+a.substr(3)]():t[a]||0,P[a]=u+g(h,k,b,x));for(a in r)if("resistance"!==a&&"checkpoint"!==a&&"preventOvershoot"!==a&&"linkedProps"!==a&&"radius"!==a){if("function"==typeof(p=r[a])&&(p=p(s,t)),"number"==typeof p)h=Number(p)||0;else if("object"!=typeof p||isNaN(p.velocity)){if(!(m=m||e.getByTarget(t))||!m.isTrackingProp(a))throw"ERROR: No velocity was defined in the throwProps tween of "+t+" property: "+a;h=m.getVelocity(a)}else h=Number(p.velocity);y=g(h,k,b,x),_=0,u=(v="function"==typeof t[a])?t[a.indexOf("set")||"function"!=typeof t["get"+a.substr(3)]?a:"get"+a.substr(3)]():t[a],"object"==typeof p&&(d=u+y,void 0!==p.end&&(p=l(p,P&&a in P?P:d,p.max,p.min,a,r.radius),c&&(r[a]=f(p,r[a],"end"))),void 0!==p.max&&Number(p.max)<d?N||p.preventOvershoot?y=p.max-u:_=p.max-u-y:void 0!==p.min&&Number(p.min)>d&&(N||p.preventOvershoot?y=p.min-u:_=p.min-u-y)),this._overwriteProps[V]=a,this._props[V++]={p:a,s:u,c1:y,c2:_,f:v,r:!1}}return!0},y._kill=function(e){for(var t=this._props.length;--t>-1;)null!=e[this._props[t].p]&&this._props.splice(t,1);return TweenPlugin.prototype._kill.call(this,e)},y._mod=function(e){for(var t,r=this._props,n=r.length;--n>-1;)"function"==typeof(t=e[r[n].p]||e.throwProps)&&(r[n].m=t)},y.setRatio=function(e){for(var t,r,n=this._props.length;--n>-1;)r=(t=this._props[n]).s+t.c1*e+t.c2*e*e,t.m?r=t.m(r,this.target):1===e&&(r=(1e4*r+(r<0?-.5:.5)|0)/1e4),t.f?this.target[t.p](r):this.target[t.p]=r},TweenPlugin.activate([o]),o},!0),_gsScope._gsDefine("utils.VelocityTracker",["TweenLite"],function(){var e,t,r,n=/([A-Z])/g,i={},o=_gsScope.document,s={x:1,y:1,z:2,scale:1,scaleX:1,scaleY:1,rotation:1,rotationZ:1,rotationX:2,rotationY:2,skewX:1,skewY:1,xPercent:1,yPercent:1},a=o.defaultView?o.defaultView.getComputedStyle:function(){},c=function(e,t,r){var o=(e._gsTransform||i)[t];return o||0===o?o:(e.style[t]?o=e.style[t]:(r=r||a(e,null))?o=r[t]||r.getPropertyValue(t)||r.getPropertyValue(t.replace(n,"-$1").toLowerCase()):e.currentStyle&&(o=e.currentStyle[t]),parseFloat(o)||0)},p=TweenLite.ticker,u=function(e,t,r){this.p=e,this.f=t,this.v1=this.v2=0,this.t1=this.t2=p.time,this.css=!1,this.type="",this._prev=null,r&&(this._next=r,r._prev=this)},l=function(){var t,n,i=e,o=p.time;if(o-r>=.03)for(r,r=o;i;){for(n=i._firstVP;n;)((t=n.css?c(i.target,n.p):n.f?i.target[n.p]():i.target[n.p])!==n.v1||o-n.t1>.15)&&(n.v2=n.v1,n.v1=t,n.t2=n.t1,n.t1=o),n=n._next;i=i._next}},f=function(n){this._lookup={},this.target=n,this.elem=!(!n.style||!n.nodeType),t||(p.addEventListener("tick",l,null,!1,-100),r=p.time,t=!0),e&&(this._next=e,e._prev=this),e=this},g=f.getByTarget=function(t){for(var r=e;r;){if(r.target===t)return r;r=r._next}},v=f.prototype;return v.addProp=function(e,t){if(!this._lookup[e]){var r=this.target,n="function"==typeof r[e],i=n?this._altProp(e):e,o=this._firstVP;this._firstVP=this._lookup[e]=this._lookup[i]=o=new u(i!==e&&0===e.indexOf("set")?i:e,n,o),o.css=this.elem&&(void 0!==this.target.style[o.p]||s[o.p]),o.css&&s[o.p]&&!r._gsTransform&&TweenLite.set(r,{x:"+=0",overwrite:!1}),o.type=t||o.css&&0===e.indexOf("rotation")?"deg":"",o.v1=o.v2=o.css?c(r,o.p):n?r[o.p]():r[o.p]}},v.removeProp=function(e){var t=this._lookup[e];t&&(t._prev?t._prev._next=t._next:t===this._firstVP&&(this._firstVP=t._next),t._next&&(t._next._prev=t._prev),this._lookup[e]=0,t.f&&(this._lookup[this._altProp(e)]=0))},v.isTrackingProp=function(e){return this._lookup[e]instanceof u},v.getVelocity=function(e){var t,r,n=this._lookup[e],i=this.target;if(!n)throw"The velocity of "+e+" is not being tracked.";return t=(n.css?c(i,n.p):n.f?i[n.p]():i[n.p])-n.v2,"rad"!==n.type&&"deg"!==n.type||(t%=r="rad"===n.type?2*Math.PI:360)!==t%(r/2)&&(t=t<0?t+r:t-r),t/(p.time-n.t2)},v._altProp=function(e){var t=e.substr(0,3),r=("get"===t?"set":"set"===t?"get":t)+e.substr(3);return"function"==typeof this.target[r]?r:e},f.getByTarget=function(t){var r=e;for("string"==typeof t&&(t=TweenLite.selector(t)),t.length&&t!==window&&t[0]&&t[0].style&&!t.nodeType&&(t=t[0]);r;){if(r.target===t)return r;r=r._next}},f.track=function(e,t,r){var n=g(e),i=t.split(","),o=i.length;for(r=(r||"").split(","),n||(n=new f(e));--o>-1;)n.addProp(i[o],r[o]||r[0]);return n},f.untrack=function(t,r){var n=g(t),i=(r||"").split(","),o=i.length;if(n){for(;--o>-1;)n.removeProp(i[o]);n._firstVP&&r||(n._prev?n._prev._next=n._next:n===e&&(e=n._next),n._next&&(n._next._prev=n._prev))}},f.isTracking=function(e,t){var r=g(e);return!!r&&(!(t||!r._firstVP)||r.isTrackingProp(t))},f},!0);export const ThrowPropsPlugin=_gsScope.ThrowPropsPlugin;export{ThrowPropsPlugin as default};export const VelocityTracker=_gsScope.com.greensock.utils.VelocityTracker;
