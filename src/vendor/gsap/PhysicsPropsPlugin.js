/*!
 * VERSION: 0.2.1
 * DATE: 2018-05-30
 * UPDATES AND DOCS AT: http://greensock.com
 *
 * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
 * PhysicsPropsPlugin is a Club GreenSock membership benefit; You must have a valid membership to use
 * this code without violating the terms of use. Visit http://greensock.com/club/ to sign up or get more details.
 * This work is subject to the software agreement that was issued with your membership.
 * 
 * @author: Jack Doyle, jack@greensock.com
 */
import{_gsScope}from"gsap/TweenLite.js";var PhysicsProp=function(s,i,t,e,o,r){this.p=i,this.f="function"==typeof s[i],this.start=this.value=this.f?s[i.indexOf("set")||"function"!=typeof s["get"+i.substr(3)]?i:"get"+i.substr(3)]():parseFloat(s[i]),this.velocity=t||0,this.v=this.velocity/r,e||0==e?(this.acceleration=e,this.a=this.acceleration/(r*r)):this.acceleration=this.a=0,this.friction=1-(o||0)},_random=Math.random(),_globals=_gsScope._gsDefine.globals,_rootFramesTimeline=_globals.com.greensock.core.Animation._rootFramesTimeline,PhysicsPropsPlugin=_gsScope._gsDefine.plugin({propName:"physicsProps",version:"0.2.1",API:2,init:function(s,i,t,e){"function"==typeof i&&(i=i(s)),this._target=s,this._tween=t,this._runBackwards=!0===t.vars.runBackwards,this._step=0;for(var o,r,n=t._timeline,p=0;n._timeline;)n=n._timeline;for(o in this._stepsPerTimeUnit=n===_rootFramesTimeline?1:30,this._props=[],i)"function"==typeof(r=i[o])&&(r=r(e,s)),(r.velocity||r.acceleration)&&(this._props[p++]=new PhysicsProp(s,o,r.velocity,r.acceleration,r.friction,this._stepsPerTimeUnit),this._overwriteProps[p]=o,r.friction&&(this._hasFriction=!0));return!0},set:function(s){var i,t,e,o,r,n,p=this._props.length,a=this._tween._time,c=this._target;if(this._runBackwards&&(a=this._tween._duration-a),this._hasFriction){if(o=(a*=this._stepsPerTimeUnit)%1,(e=(0|a)-this._step)>=0)for(;--p>-1;){for(i=this._props[p],r=e;--r>-1;)i.v+=i.a,i.v*=i.friction,i.value+=i.v;t=i.value+i.v*o,i.m&&(t=i.m(t,c)),i.f?c[i.p](t):c[i.p]=t}else for(;--p>-1;){for(i=this._props[p],r=-e;--r>-1;)i.value-=i.v,i.v/=i.friction,i.v-=i.a;t=i.value+i.v*o,i.m&&(t=i.m(t,c)),i.f?c[i.p](t):c[i.p]=t}this._step+=e}else for(n=a*a*.5;--p>-1;)t=(i=this._props[p]).start+(i.velocity*a+i.acceleration*n),i.m&&(t=i.m(t,c)),i.f?c[i.p](t):c[i.p]=t}}),p=PhysicsPropsPlugin.prototype;p._kill=function(s){for(var i=this._props.length;--i>-1;)this._props[i].p in s&&this._props.splice(i,1);return this._super._kill.call(this,s)},p._mod=function(s){for(var i,t=this._props.length;--t>-1;)"function"==typeof(i=s[this._props[t].p]||s.physicsProps)&&(this._props[t].m=i)},PhysicsPropsPlugin._autoCSS=!0,PhysicsPropsPlugin._cssRegister=function(){var s=_globals.CSSPlugin;if(s){var i=s._internals,t=i._parseToProxy,e=i._setPluginRatio,o=i.CSSPropTween;i._registerComplexSpecialProp("physicsProps",{parser:function(s,i,r,n,p,a){a=new PhysicsPropsPlugin;var c,l,h={};for(c in i.scale&&(i.scaleX=i.scaleY=i.scale,delete i.scale),i)h[c]=_random++;return l=t(s,h,n,p,a),(p=new o(s,"physicsProps",0,0,l.pt,2)).data=l,p.plugin=a,p.setRatio=e,a._onInitTween(l.proxy,i,n._tween),p}})}};export{PhysicsPropsPlugin,PhysicsPropsPlugin as default};
